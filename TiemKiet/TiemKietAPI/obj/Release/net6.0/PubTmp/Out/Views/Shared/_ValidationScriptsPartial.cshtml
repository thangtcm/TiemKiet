<script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-app.js" type="text/javascript"></script>
<script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-messaging.js" type="text/javascript"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
        integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-migrate/3.4.1/jquery-migrate.min.js"
        integrity="sha512-KgffulL3mxrOsDicgQWA11O6q6oKeWcV00VxgfJw4TcM8XRQT8Df9EsrYxDf7tpVpfl3qcYD96BpyPvA4d1FDQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js"
        integrity="sha512-CEiA+78TpP9KAIPzqBvxUv8hy41jyI3f2uHi7DGp/Y/Ka973qgSdybNegWFciqh6GrN2UePx2KkflnQUbUhNIA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.stellar@0.6.2/jquery.stellar.min.js"></script>
<script src="~/js/scrolljax.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.sticky/1.0.4/jquery.sticky.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-animateNumber/0.0.14/jquery.animateNumber.min.js"></script>
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"
        integrity="sha512-IsNh5E3eYy3tr/JiX2Yx4vsCujtkhwl7SLqgnwLNgf04Hrt9BT9SXlLlZlWx+OK4ndzAoALhsMNcCmkggjZB1w=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"
        integrity="sha512-IsNh5E3eYy3tr/JiX2Yx4vsCujtkhwl7SLqgnwLNgf04Hrt9BT9SXlLlZlWx+OK4ndzAoALhsMNcCmkggjZB1w=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.8/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/js/intlTelInput.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/SlickNav/1.0.10/jquery.slicknav.min.js" integrity="sha512-FmCXNJaXWw1fc3G8zO3WdwR2N23YTWDFDTM3uretxVIbZ7lvnjHkciW4zy6JGvnrgjkcNEk8UNtdGTLs2GExAw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<!--Notification-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js" integrity="sha512-VEd+nq25CkR676O+pLBnDW09R7VQX9Mdiij052gVCp5yVH3jGtH70Ho/UUv4mJDsEdTvqRCFZg0NKGiojGnUCw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="~/lib/owlcarousel/owl.carousel.min.js"></script>
<script src="~/js/moment-with-locales.min.js"></script>
<script src="~/js/bootstrap-datetimepicker.min.js"></script>
<script src="~/js/slicknav.js"></script>
<script src="~/js/main.js"></script>
<script src="~/js/func.js"></script>
<script defer src="~/js/notification.js"></script>
<script src="~/js/toastrjs.js"></script>
<script>
    $('#phoneNumber').on('input', function () {
        var phoneNumber = $(this).val();
        console.log(phoneNumber);
        var sendOTPBtn = $('#sendOTPBtn');
        var phoneNumberError = $('#phoneNumberError');

        if (isValidPhoneNumber(phoneNumber)) {
            sendOTPBtn.prop('disabled', false);
            phoneNumberError.text(''); // Xóa thông báo lỗi nếu có
        } else {
            sendOTPBtn.prop('disabled', true);
            phoneNumberError.text('Số điện thoại không hợp lệ.');
        }
    });
    $('.add-to-cart-btn').on('click', function (e) {
        e.preventDefault();

        var productId = $(this).data('product-id');

        // Kiểm tra sự tồn tại của các phần tử DOM
        var sizeProductSelect = $(`#sizeProductSelect${productId}`);
        var iceProductSelect = $(`#iceProductSelect${productId}`);
        var numProductInput = $(`#num-product${productId}`);

        var upsize = sizeProductSelect.val()
        var addIce = iceProductSelect.val();
        var quantity = numProductInput.val();
        var currentBranchId = $('#currentBranchId').val();
        if(upsize == "" || addIce == "")
        {
            toastr.error('Vui lòng điền đủ thông tin.', 'Lỗi');
            return;
        }
        console.log('Dữ liệu là : ' + productId + ' upsize' + upsize + ' addIce' + addIce + ' quantity' + quantity + "currentBranchId " + currentBranchId);

        // Thực hiện Ajax request với các giá trị đã lấy được
        $.ajax({
            url: '/Cart/AddToCart',
            method: 'POST',
            data: {
                productId: productId,
                upsize: upsize,
                addIce: addIce,
                quantity: quantity,
                branchId: currentBranchId
            },
            success: function (result) {
                $('.cartItemCount').each(function () {
                    $(this).data('notify', result).attr('data-notify', result);
                });

                toastr.success('Thêm vào giỏ hàng thành công.', 'Thành công');
                $(`#ViewProductModal${productId}`).modal('hide');
            },
            error: function (error) {
                console.error('Error adding to cart:', error);
                toastr.error('Đã có lỗi xảy ra', 'Lỗi');
            }
        });
    });
</script>
